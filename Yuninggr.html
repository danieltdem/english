<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 9: éå»å¼ vs å®Œæˆå¼å¤§æŒ‘æˆ°</title>
    <style>
        /* CSS styles based on your original code */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); /* Changed to a lighter, magical theme */
            padding: 20px;
            box-sizing: border-box;
        }
        ruby {
            ruby-position: over;
        }
        rt {
            font-size: 0.7em;
            opacity: 0.9;
        }
        .container {
            text-align: center;
            background: white;
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 600px;
            transition: all 0.3s ease;
        }
        h1 {
            color: #333;
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 28px;
        }
        p {
            color: #666;
            margin-bottom: 20px;
            font-size: 16px;
        }
        #game-image {
            transition: all 0.5s ease;
        }
        #game-image.correct {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }
        #game-image.incorrect {
            animation: shake 0.5s;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }
        #game-image.all-correct {
            animation: celebration 1s ease-in-out;
            box-shadow: 0 8px 25px rgba(253, 203, 110, 0.4);
        }
        #game-status {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.5s ease;
        }
        #game-status.correct {
            background: linear-gradient(135deg, #00b894, #00a085);
            transform: scale(1.1);
        }
        #game-status.incorrect {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            animation: shake 0.5s;
        }
        #game-status.all-correct {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            animation: celebration 1s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        @keyframes celebration {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(5deg); }
        }
        #progress {
            font-size: 16px;
            color: #555;
            margin-bottom: 15px;
            font-weight: bold;
            padding: 8px 16px;
            background: #f8f9fa;
            border-radius: 20px;
            display: inline-block;
        }
        #question {
            font-size: 22px;
            margin: 20px 0;
            color: #2c3e50;
            line-height: 1.5;
            background: #f1f3f4;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #74b9ff;
        }
        #options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        .option-btn {
            padding: 15px 20px;
            font-size: 18px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            text-align: center;
            transform: translateY(0);
        }
        .option-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #0984e3, #74b9ff);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .option-btn.correct {
            background: linear-gradient(135deg, #00b894, #00a085) !important;
            transform: scale(1.05);
        }
        .option-btn.incorrect {
            background: linear-gradient(135deg, #fd79a8, #e84393) !important;
            animation: shake 0.5s;
        }
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        #result {
            font-size: 24px;
            margin-top: 20px;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
            line-height: 1.5;
        }
        #explanation-container {
            font-size: 16px;
            margin-top: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #fffbe6, #fff3cd);
            border-left: 5px solid #f39c12;
            border-radius: 10px;
            text-align: left;
            line-height: 1.8;
            color: #5f4c0a;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        #score {
            font-size: 24px;
            margin-top: 10px;
            color: #333;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-weight: bold;
            line-height: 1.5;
        }
        #wrong-questions {
            font-size: 16px;
            margin-top: 20px;
            text-align: left;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #e74c3c;
            max-height: 250px;
            overflow-y: auto;
            line-height: 1.8;
        }
        #next-btn, #restart-btn, #retest-wrong-btn {
            padding: 15px 30px;
            font-size: 18px;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        #next-btn { 
            background: linear-gradient(135deg, #fdcb6e, #e17055);
        }
        #next-btn:hover { 
            background: linear-gradient(135deg, #e17055, #fdcb6e);
            transform: translateY(-2px);
        }
        #restart-btn { 
            background: linear-gradient(135deg, #00cec9, #00b894);
        }
        #restart-btn:hover { 
            background: linear-gradient(135deg, #00b894, #00cec9);
            transform: translateY(-2px);
        }
        #retest-wrong-btn { 
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
        }
        #retest-wrong-btn:hover { 
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="game-status">ğŸ§™â€â™€ï¸</div>
        
        <h1><ruby>æ™‚<rt>ã„•ËŠ</rt></ruby><ruby>æ…‹<rt>ã„Šã„Ë‹</rt></ruby><ruby>å¤§<rt>ã„‰ã„šË‹</rt></ruby><ruby>æŒ‘<rt>ã„Šã„§ã„ </rt></ruby><ruby>æˆ°<rt>ã„“ã„¢Ë‹</rt></ruby></h1>
        <p>Past Simple vs. Present Perfect Simple</p>
        <p><ruby>è«‹<rt>ã„‘ã„§ã„¥Ë‡</rt></ruby><ruby>é¸<rt>ã„’ã„©ã„¢Ë‡</rt></ruby><ruby>å‡º<rt>ã„”ã„¨</rt></ruby><ruby>æ­£<rt>ã„“ã„¥Ë‹</rt></ruby><ruby>ç¢º<rt>ã„‘ã„©ã„Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ¡ˆ<rt>ã„¢Ë‹</rt></ruby>ï¼</p>
        
        <div id="quiz-area">
            <div id="progress"></div>
            <div id="question"></div>
            <div id="options-container"></div>
            <div id="result"></div>
            <div id="explanation-container" style="display: none;"></div>
            <button id="next-btn" style="display: none;"><ruby>ä¸‹<rt>ã„’ã„§ã„šË‹</rt></ruby><ruby>ä¸€<rt>ã„§ËŠ</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby> â¡ï¸</button>
        </div>

        <div id="end-screen" style="display: none;">
            <h2>ğŸŠ <ruby>æ¸¬<rt>ã„˜ã„œË‹</rt></ruby><ruby>é©—<rt>ã„§ã„¢Ë‹</rt></ruby><ruby>çµ<rt>ã„ã„§ã„ËŠ</rt></ruby><ruby>æŸ<rt>ã„•ã„¨Ë‹</rt></ruby>ï¼ ğŸŠ</h2>
            <div id="score"></div>
            <div id="wrong-questions"></div>
            <button id="restart-btn">ğŸ”„ <ruby>å…¨<rt>ã„‘ã„©ã„¢ËŠ</rt></ruby><ruby>éƒ¨<rt>ã„…ã„¨Ë‹</rt></ruby><ruby>é‡<rt>ã„”ã„¨ã„¥ËŠ</rt></ruby><ruby>æ¸¬<rt>ã„˜ã„œË‹</rt></ruby></button>
            <button id="retest-wrong-btn" style="display: none;">âŒ <ruby>é‡<rt>ã„”ã„¨ã„¥ËŠ</rt></ruby><ruby>æ¸¬<rt>ã„˜ã„œË‹</rt></ruby><ruby>éŒ¯<rt>ã„˜ã„¨ã„›Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby></button>
        </div>
    </div>

    <script>
        // é€™è£¡è¨­å®šå…¨éƒ¨çš„é¡Œç›®ï¼ŒåŒ…å«äº† Unit 9 çš„é‡é»
        const allQuestions = [
            // åŸºç¤æ™‚é–“é—œéµå­—é¡Œ
            { question: "I ______ to the park yesterday.", options: ["went", "have gone"], answer: 0, explanation: "çœ‹åˆ° 'yesterday' (æ˜¨å¤©) æ˜¯éå»æ˜ç¢ºçš„æ™‚é–“ï¼Œè¦ç”¨ Past Simple (éå»å¼)ã€‚" },
            { question: "She ______ him three days ago.", options: ["met", "has met"], answer: 0, explanation: "çœ‹åˆ° 'ago' (ä¹‹å‰) æ˜¯éå»æ˜ç¢ºçš„æ™‚é–“ï¼Œè¦ç”¨ Past Simple (éå»å¼)ã€‚" },
            { question: "We ______ to Japan in 2010.", options: ["flew", "have flown"], answer: 0, explanation: "çœ‹åˆ° 'in 2010' (ç‰¹å®šå¹´ä»½) å·²ç¶“éå»äº†ï¼Œè¦ç”¨ Past Simple (éå»å¼)ã€‚" },
            { question: "______ you ever ______ a ghost?", options: ["Did / see", "Have / seen"], answer: 1, explanation: "çœ‹åˆ° 'ever' (æ›¾ç¶“)ï¼Œæ˜¯åœ¨å•ç¶“é©—ï¼Œè¦ç”¨ Present Perfect (å®Œæˆå¼)ã€‚" },
            
            // For & Since
            { question: "I ______ here for ten years. (I still live here)", options: ["lived", "have lived"], answer: 1, explanation: "ä½¿ç”¨ 'for' åŠ ä¸Šä¸€æ®µæ™‚é–“ï¼Œä¸”å‹•ä½œæŒçºŒåˆ°ç¾åœ¨ï¼Œè¦ç”¨ Present Perfect (å®Œæˆå¼)ã€‚" },
            { question: "She has known him ______ Monday.", options: ["since", "for"], answer: 0, explanation: "Monday æ˜¯ä¸€å€‹æ™‚é–“é»ï¼Œè¦ç”¨ 'since' (è‡ªå¾)ã€‚" },
            { question: "She has known him ______ three years.", options: ["since", "for"], answer: 1, explanation: "Three years æ˜¯ä¸€æ®µæ™‚é–“ï¼Œè¦ç”¨ 'for' (æŒçºŒ)ã€‚" },
            
            // å‰›ç™¼ç”Ÿ/çµæœ (Just, Already, Yet)
            { question: "I have ______ finished my homework.", options: ["just", "yesterday"], answer: 0, explanation: "å®Œæˆå¼å¸¸æ­é… 'just' (å‰›å‰›)ã€‚'yesterday' åªèƒ½ç”¨åœ¨éå»å¼ã€‚" },
            { question: "Have you finished your lunch ______?", options: ["yet", "just"], answer: 0, explanation: "ç–‘å•å¥æˆ–å¦å®šå¥ä¸­çš„ã€Œå°šæœª/é‚„æ²’ã€ï¼Œè¦ç”¨ 'yet'ï¼Œé€šå¸¸æ”¾åœ¨å¥å°¾ã€‚" },
            { question: "Look! I ______ a new dress!", options: ["bought", "have bought"], answer: 1, explanation: "å¼·èª¿ç¾åœ¨æ“æœ‰çš„ã€Œçµæœã€(ä½ çœ‹ï¼æˆ‘æœ‰æ–°æ´‹è£)ï¼Œè€Œä¸æ˜¯å¼·èª¿éå»ä½•æ™‚è²·çš„ï¼Œç”¨ Present Perfect (å®Œæˆå¼)ã€‚" },
            
            // æ˜“æ··æ·†é¡Œ
            { question: "I ______ my key. I can't open the door now.", options: ["lost", "have lost"], answer: 1, explanation: "å¼·èª¿ã€Œç¾åœ¨é‘°åŒ™é‚„æ˜¯å¼„ä¸Ÿçš„ç‹€æ…‹ã€(å°ç¾åœ¨æœ‰å½±éŸ¿)ï¼Œç”¨ Present Perfect (å®Œæˆå¼)ã€‚" },
            { question: "When ______ you ______ that bag?", options: ["did / buy", "have / bought"], answer: 0, explanation: "ç”¨ 'When' (ä½•æ™‚) è©¢å•æ™‚ï¼Œä¸€å®šæ˜¯åœ¨å•éå»æŸå€‹æ™‚é–“é»ï¼Œå¿…é ˆç”¨ Past Simple (éå»å¼)ã€‚" },
            { question: "Broomy ______ the Witches Award in 1999.", options: ["won", "has won"], answer: 0, explanation: "æœ‰æ˜ç¢ºçš„éå»æ™‚é–“ 'in 1999'ï¼Œå°±åƒèˆŠç…§ç‰‡ä¸€æ¨£ï¼Œç”¨ Past Simple (éå»å¼)ã€‚" },
            
            // èª²æœ¬ Broomy & Kelly çš„æ•…äº‹æ‡‰ç”¨
            { question: "Broomy ______ how to turn a man into a frog in 165 BC.", options: ["discovered", "has discovered"], answer: 0, explanation: "è¥¿å…ƒå‰ 165 å¹´ (165 BC) æ˜¯å¾ˆä¹…ä»¥å‰çš„ç‰¹å®šæ™‚é–“ï¼Œç”¨ Past Simple (éå»å¼)ã€‚" },
            { question: "She ______ Magic Arts for 2000 years.", options: ["has studied", "studied"], answer: 0, explanation: "å¥¹æŒçºŒå­¸ç¿’äº† 2000 å¹´ä¸”ç¾åœ¨é‚„åœ¨å­¸ (for + ä¸€æ®µæ™‚é–“)ï¼Œç”¨ Present Perfect (å®Œæˆå¼)ã€‚" },
            { question: "______ long have you been a witch?", options: ["How", "When"], answer: 0, explanation: "è©¢å•ã€ŒæŒçºŒå¤šä¹…ã€è¦ç”¨ 'How long'ã€‚" },
            { question: "Kelly ______ computer games last month.", options: ["played", "has played"], answer: 0, explanation: "'last month' (ä¸Šå€‹æœˆ) æ˜¯éå»å¼é—œéµå­—ã€‚" },
            { question: "I ______ 60 hours on this game since then!", options: ["spent", "have spent"], answer: 1, explanation: "çœ‹åˆ° 'since' (è‡ªå¾é‚£æ™‚åˆ°ç¾åœ¨)ï¼Œè¦ç”¨ Present Perfect (å®Œæˆå¼)ã€‚" },
            
            // å¦å®šèˆ‡å°è©±
            { question: "I ______ see him yesterday.", options: ["didn't", "haven't"], answer: 0, explanation: "éå»å¼ (yesterday) çš„å¦å®šè¦ç”¨ didn'tã€‚" },
            { question: "A: Would you like some cake? B: No, thanks. I ______ lunch.", options: ["just had", "have just had"], answer: 1, explanation: "æ‹’çµ•è›‹ç³•æ˜¯å› ç‚ºã€Œå‰›å‰›åƒé£½äº†ã€(å¼·èª¿ç¾åœ¨ä¸é¤“çš„çµæœ)ï¼Œç”¨ Present Perfect (å®Œæˆå¼)ã€‚" }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let questions = [];
        let wrongQuestions = [];

        const quizArea = document.getElementById('quiz-area');
        const endScreen = document.getElementById('end-screen');
        const questionEl = document.getElementById('question');
        const optionsContainer = document.getElementById('options-container');
        const resultEl = document.getElementById('result');
        const explanationEl = document.getElementById('explanation-container');
        const progressEl = document.getElementById('progress');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const retestWrongBtn = document.getElementById('retest-wrong-btn');
        const gameStatus = document.getElementById('game-status');

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function startGame(questionList) {
            questions = [...questionList];
            shuffle(questions);
            currentQuestionIndex = 0;
            score = 0;
            wrongQuestions = [];
            
            quizArea.style.display = 'block';
            endScreen.style.display = 'none';
            gameStatus.textContent = 'ğŸ§™â€â™€ï¸';
            gameStatus.className = '';
            
            showQuestion();
        }

        function showQuestion() {
            resetState();
            const currentQuestion = questions[currentQuestionIndex];
            progressEl.innerHTML = `<ruby>ç¬¬<rt>ã„‰ã„§Ë‹</rt></ruby> ${currentQuestionIndex + 1} / ${questions.length} <ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby>`;
            questionEl.textContent = currentQuestion.question;

            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-btn');
                button.dataset.index = index;
                button.addEventListener('click', selectAnswer);
                optionsContainer.appendChild(button);
            });
        }

        function resetState() {
            resultEl.innerHTML = '';
            explanationEl.style.display = 'none';
            nextBtn.style.display = 'none';
            while (optionsContainer.firstChild) {
                optionsContainer.removeChild(optionsContainer.firstChild);
            }
            gameStatus.textContent = 'ğŸ§™â€â™€ï¸';
            gameStatus.className = '';
        }

        function selectAnswer(e) {
            const selectedBtn = e.target;
            const selectedIndex = parseInt(selectedBtn.dataset.index);
            const currentQuestion = questions[currentQuestionIndex];
            const correctIndex = currentQuestion.answer;

            Array.from(optionsContainer.children).forEach(button => {
                button.disabled = true;
            });

            if (selectedIndex === correctIndex) {
                score++;
                selectedBtn.classList.add('correct');
                resultEl.innerHTML = 'âœ… <ruby>æ­£<rt>ã„“ã„¥Ë‹</rt></ruby><ruby>ç¢º<rt>ã„‘ã„©ã„Ë‹</rt></ruby>ï¼<ruby>å¤ª<rt>ã„Šã„Ë‹</rt></ruby><ruby>æ£’<rt>ã„…ã„¤Ë‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼';
                resultEl.style.color = '#2ecc71';
                gameStatus.textContent = 'ğŸ‰';
                gameStatus.classList.add('correct');
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    if (currentQuestionIndex < questions.length) {
                        showQuestion();
                    } else {
                        endGame();
                    }
                }, 1200);
            } else {
                selectedBtn.classList.add('incorrect');
                optionsContainer.children[correctIndex].classList.add('correct');
                resultEl.innerHTML = 'âŒ <ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>éŒ¯<rt>ã„˜ã„¨ã„›Ë‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼Œ<ruby>å†<rt>ã„—ã„Ë‹</rt></ruby><ruby>æ¥<rt>ã„ã„§ã„</rt></ruby><ruby>å†<rt>ã„—ã„Ë‹</rt></ruby><ruby>å²<rt>ã„Œã„§Ë‹</rt></ruby>ï¼';
                resultEl.style.color = '#e74c3c';
                gameStatus.textContent = 'ğŸ˜…';
                gameStatus.classList.add('incorrect');
                
                explanationEl.innerHTML = `ğŸ’¡ <ruby>æ–‡<rt>ã„¨ã„£ËŠ</rt></ruby><ruby>æ³•<rt>ã„ˆã„šË‡</rt></ruby><ruby>è§£<rt>ã„ã„§ã„Ë‡</rt></ruby><ruby>æ<rt>ã„’ã„§</rt></ruby>ï¼š<br>${currentQuestion.explanation}`;
                explanationEl.style.display = 'block';

                wrongQuestions.push({
                    ...currentQuestion,
                    userAnswer: currentQuestion.options[selectedIndex]
                });
                nextBtn.style.display = 'block';
            }
        }

        function endGame() {
            quizArea.style.display = 'none';
            endScreen.style.display = 'block';
            
            const scoreEl = document.getElementById('score');
            scoreEl.innerHTML = `ğŸ¯ <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>æœ€<rt>ã„—ã„¨ã„ŸË‹</rt></ruby><ruby>çµ‚<rt>ã„“ã„¨ã„¥</rt></ruby><ruby>åˆ†<rt>ã„ˆã„£</rt></ruby><ruby>æ•¸<rt>ã„•ã„¨Ë‹</rt></ruby>ï¼š${score} / ${questions.length} (${Math.round(score/questions.length*100)}%)`;

            const wrongQuestionsEl = document.getElementById('wrong-questions');
            if (score === questions.length) {
                gameStatus.textContent = 'ğŸ†';
                gameStatus.classList.add('all-correct');
                wrongQuestionsEl.innerHTML = 'ğŸŠ <ruby>å¤ª<rt>ã„Šã„Ë‹</rt></ruby><ruby>æ£’<rt>ã„…ã„¤Ë‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼<ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>å…¨<rt>ã„‘ã„©ã„¢ËŠ</rt></ruby><ruby>éƒ¨<rt>ã„…ã„¨Ë‹</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>å°<rt>ã„‰ã„¨ã„ŸË‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼<ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>å·²<rt>ã„§Ë‡</rt></ruby><ruby>ç¶“<rt>ã„ã„§ã„¥</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> Past & Perfect <ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>å°<rt>ã„’ã„§ã„ Ë‡</rt></ruby><ruby>å°ˆ<rt>ã„“ã„¨ã„¢</rt></ruby><ruby>å®¶<rt>ã„ã„§ã„š</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼ ğŸŠ';
                wrongQuestionsEl.style.borderLeftColor = '#2ecc71';
                wrongQuestionsEl.style.background = '#d4edda';
                wrongQuestionsEl.style.color = '#155724';
                wrongQuestionsEl.style.display = 'block';
                retestWrongBtn.style.display = 'none';
            } else {
                gameStatus.textContent = 'ğŸ“';
                let wrongText = `<h3>ğŸ“‹ <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>éŒ¯<rt>ã„˜ã„¨ã„›Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby><ruby>ç›®<rt>ã„‡ã„¨Ë‹</rt></ruby><ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>é¡§<rt>ã„ã„¨Ë‹</rt></ruby>ï¼š</h3>`;
                wrongQuestions.forEach((q, index) => {
                    wrongText += `<p>`;
                    wrongText += `${index + 1}. ${q.question}<br>`;
                    wrongText += `&nbsp;&nbsp;&nbsp;<ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ¡ˆ<rt>ã„¢Ë‹</rt></ruby>: "${q.userAnswer}" âŒ<br>`;
                    wrongText += `&nbsp;&nbsp;&nbsp;<ruby>æ­£<rt>ã„“ã„¥Ë‹</rt></ruby><ruby>ç¢º<rt>ã„‘ã„©ã„Ë‹</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ¡ˆ<rt>ã„¢Ë‹</rt></ruby>: "${q.options[q.answer]}" âœ…<br>`;
                    wrongText += `&nbsp;&nbsp;&nbsp;<ruby>è§£<rt>ã„ã„§ã„Ë‡</rt></ruby><ruby>æ<rt>ã„’ã„§</rt></ruby>: ${q.explanation}<br>`;
                    wrongText += `</p>`;
                });
                wrongQuestionsEl.innerHTML = wrongText;
                wrongQuestionsEl.style.borderLeftColor = '#e74c3c';
                wrongQuestionsEl.style.background = '#f8d7da';
                wrongQuestionsEl.style.color = '#721c24';
                wrongQuestionsEl.style.display = 'block';
                retestWrongBtn.style.display = 'inline-block';
            }
        }
        
        nextBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                endGame();
            }
        });

        restartBtn.addEventListener('click', () => startGame(allQuestions));

        retestWrongBtn.addEventListener('click', () => {
            if (wrongQuestions.length > 0) {
                const retestList = wrongQuestions.map(({ userAnswer, ...rest }) => rest);
                startGame(retestList);
            }
        });

        startGame(allQuestions);
    </script>
</body>
</html>
