<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英文文法測驗：形容詞比較級與最高級</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            text-align: center;
            background: white;
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 600px;
            transition: all 0.3s ease;
        }
        h1 {
            color: #333;
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 28px;
        }
        p {
            color: #666;
            margin-bottom: 20px;
            font-size: 16px;
        }
        #game-image {
            transition: all 0.5s ease;
        }
        #game-image.correct {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }
        #game-image.incorrect {
            animation: shake 0.5s;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }
        #game-image.all-correct {
            animation: celebration 1s ease-in-out;
            box-shadow: 0 8px 25px rgba(253, 203, 110, 0.4);
        }
        #game-status {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.5s ease;
        }
        #game-status.correct {
            background: linear-gradient(135deg, #00b894, #00a085);
            transform: scale(1.1);
        }
        #game-status.incorrect {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            animation: shake 0.5s;
        }
        #game-status.all-correct {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            animation: celebration 1s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        @keyframes celebration {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(5deg); }
        }
        #progress {
            font-size: 16px;
            color: #555;
            margin-bottom: 15px;
            font-weight: bold;
            padding: 8px 16px;
            background: #f8f9fa;
            border-radius: 20px;
            display: inline-block;
        }
        #question {
            font-size: 22px;
            margin: 20px 0;
            color: #2c3e50;
            line-height: 1.5;
            background: #f1f3f4;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #74b9ff;
        }
        #options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        .option-btn {
            padding: 15px 20px;
            font-size: 18px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            text-align: center;
            transform: translateY(0);
        }
        .option-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #0984e3, #74b9ff);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .option-btn.correct {
            background: linear-gradient(135deg, #00b894, #00a085) !important;
            transform: scale(1.05);
        }
        .option-btn.incorrect {
            background: linear-gradient(135deg, #fd79a8, #e84393) !important;
            animation: shake 0.5s;
        }
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        #result {
            font-size: 24px;
            margin-top: 20px;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
        }
        #explanation-container {
            font-size: 16px;
            margin-top: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #fffbe6, #fff3cd);
            border-left: 5px solid #f39c12;
            border-radius: 10px;
            text-align: left;
            line-height: 1.6;
            color: #5f4c0a;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        #score {
            font-size: 24px;
            margin-top: 10px;
            color: #333;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-weight: bold;
        }
        #wrong-questions {
            font-size: 16px;
            margin-top: 20px;
            text-align: left;
            white-space: pre-wrap;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #e74c3c;
            max-height: 250px;
            overflow-y: auto;
            line-height: 1.5;
        }
        #next-btn, #restart-btn, #retest-wrong-btn {
            padding: 15px 30px;
            font-size: 18px;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        #next-btn { 
            background: linear-gradient(135deg, #fdcb6e, #e17055);
        }
        #next-btn:hover { 
            background: linear-gradient(135deg, #e17055, #fdcb6e);
            transform: translateY(-2px);
        }
        #restart-btn { 
            background: linear-gradient(135deg, #00cec9, #00b894);
        }
        #restart-btn:hover { 
            background: linear-gradient(135deg, #00b894, #00cec9);
            transform: translateY(-2px);
        }
        #retest-wrong-btn { 
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
        }
        #retest-wrong-btn:hover { 
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <img id="game-image" src="initial.png" alt="Game Scene" style="width: 150px; height: 150px; object-fit: contain; margin-bottom: 20px; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: all 0.5s ease;">
        <div id="game-status" style="display: none;">🎯</div>
        <h1>文法測驗：形容詞比較級與最高級</h1>
        <p>請根據句子情境，選擇最適合的答案。</p>
        
        <div id="quiz-area">
            <div id="progress"></div>
            <div id="question"></div>
            <div id="options-container"></div>
            <div id="result"></div>
            <div id="explanation-container" style="display: none;"></div>
            <button id="next-btn" style="display: none;">下一題 ➡️</button>
        </div>

        <div id="end-screen" style="display: none;">
            <h2>🎊 測驗結束！ 🎊</h2>
            <div id="score"></div>
            <div id="wrong-questions"></div>
            <button id="restart-btn">🔄 全部重測</button>
            <button id="retest-wrong-btn" style="display: none;">❌ 重測錯題</button>
        </div>
    </div>

    <script>
        // 存放所有題目的題庫
        // --- 原有的形容詞題目 ---
        const originalAdjectiveQuestions = [
            { question: "My brother is much _______ than I am.", options: ["tall", "taller", "the tallest", "more tall"], answer: 1, explanation: "比較兩個人時，單音節形容詞 tall 的比較級是 taller。" },
            { question: "This is _______ movie I have ever seen. It was terrible!", options: ["bad", "worse", "the worst", "the baddest"], answer: 2, explanation: "在「所有看過的電影」中比較，要用最高級。bad 的最高級是不規則變化 the worst。" },
            { question: "Your new car is _______ than your old one.", options: ["good", "gooder", "the best", "better"], answer: 3, explanation: "比較兩樣東西時，要用比較級。good 的比較級是不規則變化 better。" },
            { question: "This book is _______ than the movie.", options: ["interesting", "more interesting", "the most interesting", "interestinger"], answer: 1, explanation: "interesting 是長音節單字，比較級要在前面加 more。" },
            { question: "Of the three sisters, she is _______.", options: ["the oldest", "older", "old", "more old"], answer: 0, explanation: "比較三個人時，要用最高級 the oldest。" },
            { question: "A bicycle is _______ than a car.", options: ["less expensive", "the least expensive", "not expensive", "expensiver"], answer: 0, explanation: "表示「比較不昂貴」，應使用 less expensive than 的句型。" },
            { question: "Today is _______ than yesterday. I need to turn on the AC.", options: ["hoter", "the hottest", "hotter", "more hot"], answer: 2, explanation: "hot 是「子音-母音-子音」結尾，比較級要重複字尾 t 再加 er。" },
            { question: "My suitcase is _______ than yours. Mine is 20kg, and yours is 15kg.", options: ["heavy", "the heaviest", "heavier", "more heavy"], answer: 2, explanation: "heavy 字尾是 y，比較級要去 y 再加 ier。" },
            { question: "Tom is as _______ as his brother. They are both 170cm.", options: ["tall", "taller", "the tallest", "so tall"], answer: 0, explanation: "表示「兩者程度相同」的 as...as 句型中，要使用形容詞的原級。" },
            { question: "She is _______ girl in our school. Everyone likes her.", options: ["popular", "more popular", "the most popular", "popularest"], answer: 2, explanation: "在「全校」範圍比較，要用最高級。popular 是長音節單字，最高級是 the most popular。" },
            { question: "The library is _______ from my house than the park is.", options: ["farther", "farrer", "the farthest", "further"], answer: 0, explanation: "比較兩地「實際距離」的遠近，要用 far 的比較級 farther。" },
            { question: "Of all the fruits, the lemon is _______.", options: ["sour", "sourer", "the sourest", "more sour"], answer: 2, explanation: "在「所有水果」中比較，要用最高級 the sourest。" },
            { question: "My phone is not as _______ as the new model.", options: ["powerful", "more powerful", "so powerful", "the most powerful"], answer: 0, explanation: "在 not as...as 的句型中，要使用形容詞的原級。" },
            { question: "I have _______ time than you, so I must hurry.", options: ["little", "less", "the least", "littler"], answer: 1, explanation: "Time 是不可數名詞，比較「更少」的時間要用 little 的比較級 less。" },
            { question: "Of all my classes, English is _______.", options: ["easy", "the easiest", "easier", "the most easy"], answer: 1, explanation: "在「所有課程」中比較，要用最高級。easy 的最高級是 the easiest。" }
        ];

        // --- 新增的副詞題目 (共20題) ---
        const newAdverbQuestions = [
            { question: "He is a good singer. He sings very ______.", options: ["good", "goodly", "well", "better"], answer: 2, explanation: "修飾動詞 sings 要用副詞。good 的副詞是不規則的 well。" },
            { question: "To win the championship, Daniel practises very ______.", options: ["hard", "hardly", "harder", "more hard"], answer: 0, explanation: "修飾動詞 practises 要用副詞 hard (努力地)。hardly 的意思是「幾乎不」。" },
            { question: "Antonio is running ______ so he's going to win the race.", options: ["fast", "fastly", "faster", "fastest"], answer: 0, explanation: "修飾動詞 running 要用副詞 fast。fastly 是錯誤的用法。" },
            { question: "He has a problem with his leg and can't run ______ as Philip.", options: ["good", "well", "better", "best"], answer: 1, explanation: "在 as...as 的句型中，要用副詞的原級來修飾動詞 run，所以是 well。" },
            { question: "The people are cheering ______ for the skaters.", options: ["loud", "loudly", "louder", "loudest"], answer: 1, explanation: "修飾動詞 cheering 要用副詞 loudly (大聲地)。" },
            { question: "Which sentence has the correct adverb order?", options: ["She danced last night beautifully at the party.", "She danced beautifully last night at the party.", "She danced at the party beautifully last night.", "She danced beautifully at the party last night."], answer: 3, explanation: "副詞的黃金順序是：情態 (beautifully) → 地方 (at the party) → 時間 (last night)。" },
            { question: "I haven't seen you ______. How have you been?", options: ["late", "lately", "later", "latest"], answer: 1, explanation: "lately 的意思是「最近」，符合句意。late 的意思是「遲到」。" },
            { question: "He ______ eats breakfast; he always says he's not hungry.", options: ["hard", "hardly", "often", "neverly"], answer: 1, explanation: "hardly 的意思是「幾乎不」，符合句意。hard 是「努力地」。" },
            { question: "A car goes quickly, but a plane flies ______.", options: ["quick", "more quickly", "quicker", "the most quickly"], answer: 1, explanation: "quickly 是長音節副詞，比較級要用 more quickly。" },
            { question: "Anne drives badly, Paul drives worse, but Denise drives ______ of all.", options: ["bad", "the baddest", "worst", "the worst"], answer: 3, explanation: "比較三個人，要用最高級。badly 的最高級是不規則變化 the worst。" },
            { question: "My father always works ______ in his office.", options: ["hard", "hardly", "late", "lately"], answer: 0, explanation: "修飾動詞 works 要用副詞 hard (努力地)。" },
            { question: "Which word is an adjective, NOT an adverb?", options: ["slowly", "friendly", "quickly", "early"], answer: 1, explanation: "friendly (友善的) 是形容詞。副詞用法是 in a friendly way。" },
            { question: "He arrived ______ for the meeting.", options: ["earlily", "earlier", "early", "more early"], answer: 2, explanation: "修飾動詞 arrived 要用副詞 early。early 的副詞與形容詞同形。" },
            { question: "She speaks English more ______ than I do.", options: ["fluent", "fluently", "fluentlier", "most fluently"], answer: 1, explanation: "修飾動詞 speaks，且是比較級，要用 more + 副詞 (fluently)。" },
            { question: "Of all the students, Jenny works ______.", options: ["the hardest", "hardest", "the most hard", "the most hardly"], answer: 0, explanation: "在「所有學生」中比較，要用最高級 the hardest。" },
            { question: "Please drive ______! The road is icy.", options: ["careful", "more careful", "carefully", "caredully"], answer: 2, explanation: "修飾動詞 drive 要用副詞 carefully。" },
            { question: "I ______ go to the cinema, maybe once or twice a year.", options: ["usually", "always", "never", "rarely"], answer: 3, explanation: "rarely (很少) 最符合「一年一兩次」的頻率。" },
            { question: "He does not swim as ______ as his brother.", options: ["fast", "fastly", "faster", "fastest"], answer: 0, explanation: "在 as...as 的句型中，要使用副詞的原級 fast。" },
            { question: "Kathy did well on the test, but Betty did ______.", options: ["best", "better", "good", "weller"], answer: 1, explanation: "比較 Kathy 和 Betty 兩人，要用 well 的比較級 better。" },
            { question: "The children played ______ in the garden yesterday.", options: ["happy", "happily", "happier", "happiest"], answer: 1, explanation: "修飾動詞 played 要用副詞 happily。" }
        ];

        // --- 將新舊題庫合併 ---
        const allQuestions = [...originalAdjectiveQuestions, ...newAdverbQuestions];

        // 宣告遊戲會用到的變數
        let currentQuestionIndex = 0;
        let score = 0;
        let questions = [];
        let wrongQuestions = [];

        // 取得 HTML 頁面上的各個元素
        const quizArea = document.getElementById('quiz-area');
        const endScreen = document.getElementById('end-screen');
        const questionEl = document.getElementById('question');
        const optionsContainer = document.getElementById('options-container');
        const resultEl = document.getElementById('result');
        const explanationEl = document.getElementById('explanation-container');
        const progressEl = document.getElementById('progress');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const retestWrongBtn = document.getElementById('retest-wrong-btn');
        const gameImage = document.getElementById('game-image');
        const gameStatus = document.getElementById('game-status');
        const titleEl = document.querySelector('.container h1');

        // 打亂題目順序的函式
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // 開始遊戲的函式
        function startGame(questionList) {
            questions = [...questionList];
            shuffle(questions);
            currentQuestionIndex = 0;
            score = 0;
            wrongQuestions = [];
            
            // 更新標題
            titleEl.textContent = '文法測驗：形容詞與副詞';
            
            quizArea.style.display = 'block';
            endScreen.style.display = 'none';
            gameImage.src = 'initial.png';
            gameImage.className = '';
            gameStatus.textContent = '🎯';
            gameStatus.className = '';
            
            showQuestion();
        }

        // 顯示一道題目的函式
        function showQuestion() {
            resetState();
            const currentQuestion = questions[currentQuestionIndex];
            progressEl.textContent = `第 ${currentQuestionIndex + 1} / ${questions.length} 題`;
            questionEl.textContent = currentQuestion.question;

            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-btn');
                button.dataset.index = index;
                button.addEventListener('click', selectAnswer);
                optionsContainer.appendChild(button);
            });
        }

        // 重置畫面狀態的函式 (換到下一題前)
        function resetState() {
            resultEl.textContent = '';
            explanationEl.style.display = 'none';
            nextBtn.style.display = 'none';
            while (optionsContainer.firstChild) {
                optionsContainer.removeChild(optionsContainer.firstChild);
            }
            gameImage.src = 'initial.png';
            gameImage.className = '';
            gameStatus.textContent = '🎯';
            gameStatus.className = '';
        }

        // 選擇答案時觸發的函式
        function selectAnswer(e) {
            const selectedBtn = e.target;
            const selectedIndex = parseInt(selectedBtn.dataset.index);
            const currentQuestion = questions[currentQuestionIndex];
            const correctIndex = currentQuestion.answer;

            Array.from(optionsContainer.children).forEach(button => {
                button.disabled = true;
            });

            if (selectedIndex === correctIndex) {
                score++;
                selectedBtn.classList.add('correct');
                resultEl.textContent = '✅ 正確！太棒了！';
                resultEl.style.color = '#2ecc71';
                gameImage.src = 'correct.png';
                gameImage.classList.add('correct');
                gameStatus.textContent = '🎉';
                gameStatus.classList.add('correct');
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    if (currentQuestionIndex < questions.length) {
                        showQuestion();
                    } else {
                        endGame();
                    }
                }, 1500);
            } else {
                selectedBtn.classList.add('incorrect');
                optionsContainer.children[correctIndex].classList.add('correct');
                resultEl.textContent = '❌ 答錯了，再接再厲！';
                resultEl.style.color = '#e74c3c';
                gameImage.src = 'incorrect.png';
                gameImage.classList.add('incorrect');
                gameStatus.textContent = '😅';
                gameStatus.classList.add('incorrect');
                
                explanationEl.textContent = `💡 文法解析：${currentQuestion.explanation}`;
                explanationEl.style.display = 'block';

                wrongQuestions.push({
                    ...currentQuestion,
                    userAnswer: currentQuestion.options[selectedIndex]
                });
                nextBtn.style.display = 'block';
            }
        }

        // 遊戲結束時呼叫的函式
        function endGame() {
            quizArea.style.display = 'none';
            endScreen.style.display = 'block';
            
            const scoreEl = document.getElementById('score');
            scoreEl.textContent = `🎯 你的最終分數：${score} / ${questions.length} (${Math.round(score/questions.length*100)}%)`;

            const wrongQuestionsEl = document.getElementById('wrong-questions');
            if (score === questions.length) {
                gameImage.src = 'all_correct.png';
                gameImage.classList.add('all-correct');
                gameStatus.textContent = '🏆';
                gameStatus.classList.add('all-correct');
                wrongQuestionsEl.textContent = '🎊 太棒了！你全部答對了！你已經完全掌握形容詞與副詞的用法！ 🎊';
                wrongQuestionsEl.style.borderLeftColor = '#2ecc71';
                wrongQuestionsEl.style.background = '#d4edda';
                wrongQuestionsEl.style.color = '#155724';
                wrongQuestionsEl.style.display = 'block';
                retestWrongBtn.style.display = 'none';
            } else {
                gameImage.src = 'not_all_correct.png';
                gameStatus.textContent = '📝';
                let wrongText = '📋 你答錯的題目回顧：\n\n';
                wrongQuestions.forEach((q, index) => {
                    wrongText += `${index + 1}. ${q.question}\n`;
                    wrongText += `    你的答案: "${q.userAnswer}" ❌\n`;
                    wrongText += `    正確答案: "${q.options[q.answer]}" ✅\n`;
                    wrongText += `    解析: ${q.explanation}\n\n`;
                });
                wrongQuestionsEl.textContent = wrongText;
                wrongQuestionsEl.style.borderLeftColor = '#e74c3c';
                wrongQuestionsEl.style.background = '#f8d7da';
                wrongQuestionsEl.style.color = '#721c24';
                wrongQuestionsEl.style.display = 'block';
                retestWrongBtn.style.display = 'inline-block';
            }
        }
        
        // 點擊「下一題」按鈕
        nextBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                endGame();
            }
        });

        // 點擊「全部重測」按鈕
        restartBtn.addEventListener('click', () => startGame(allQuestions));

        // 點擊「重測錯題」按鈕
        retestWrongBtn.addEventListener('click', () => {
            if (wrongQuestions.length > 0) {
                const retestList = wrongQuestions.map(({ userAnswer, ...rest }) => rest);
                startGame(retestList);
            }
        });

        // 網頁載入後，自動開始遊戲
        startGame(allQuestions);
    </script>
</body>
</html>