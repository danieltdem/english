<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Present Perfect vs. Past Simple é‡çµ„å¥å­ç·´ç¿’</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 600px;
            text-align: center;
        }
        h2 { color: #2c3e50; }
        .instruction {
            color: #666;
            margin-bottom: 20px;
            font-size: 0.95rem;
            background-color: #e8f4fd;
            padding: 10px;
            border-radius: 8px;
            text-align: left;
        }
        .question-box {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3498db;
            margin: 20px 0;
            padding: 15px;
            border: 2px dashed #bdc3c7;
            border-radius: 10px;
        }
        input[type="text"] {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }
        input[type="text"]:focus {
            border-color: #3498db;
            outline: none;
        }
        button {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 10px 25px;
            font-size: 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover { background-color: #27ae60; }
        button#next-btn {
            background-color: #3498db;
            display: none; /* Hidden initially */
            margin-top: 10px;
        }
        .feedback {
            margin-top: 20px;
            text-align: left;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.wrong {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .grammar-tip {
            font-size: 0.9rem;
            margin-top: 5px;
            font-style: italic;
        }
        .score-board {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“ å¥å­é‡çµ„å¤§æŒ‘æˆ°</h2>
    
    <div class="instruction">
        <strong>ä½œç­”èªªæ˜ï¼š</strong><br>
        1. è«‹æ ¹æ“šæä¾›çš„å–®å­—èˆ‡æ™‚é–“é»ï¼Œåˆ¤æ–·è©²ä½¿ç”¨ <strong>Present Perfect (have/has + Vpp)</strong> æˆ–æ˜¯ <strong>Past Simple (V-ed)</strong>ã€‚<br>
        2. è«‹è¼¸å…¥å®Œæ•´çš„å¥å­ï¼Œè¨˜å¾—å¥å°¾è¦åŠ å¥é» ( . )ã€‚<br>
        3. å¤§å°å¯«éœ€æ­£ç¢º (å¥é¦–å¤§å¯«)ã€‚
    </div>

    <div id="quiz-area">
        <p>é¡Œç›® <span id="q-number">1</span> / 10</p>
        <div class="question-box" id="question-text">
            Loading...
        </div>

        <input type="text" id="user-input" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..." autocomplete="off">
        <br>
        <button id="submit-btn" onclick="checkAnswer()">é€å‡ºç­”æ¡ˆ</button>
        <button id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â¡</button>

        <div id="feedback-area" class="feedback"></div>
    </div>

    <div id="result-area" style="display:none;">
        <h3>ğŸ‰ ç·´ç¿’å®Œæˆï¼</h3>
        <p>ä½ çš„å¾—åˆ†æ˜¯ï¼š <span id="final-score" style="font-weight:bold; color:#e74c3c; font-size:1.5rem;"></span> / 100</p>
        <button onclick="restartQuiz()">å†ç·´ç¿’ä¸€æ¬¡</button>
    </div>

    <div class="score-board">
        ç›®å‰å¾—åˆ†: <span id="current-score">0</span>
    </div>
</div>

<script>
    // é¡Œç›®è³‡æ–™åº«
    const questions = [
        {
            prompt: "I / lose / my keys / yesterday",
            answer: "I lost my keys yesterday.",
            type: "Past Simple",
            reason: "æ™‚é–“é» 'yesterday' æ˜¯æ˜ç¢ºçš„éå»æ™‚é–“ï¼Œè¦ç”¨éå»å¼ã€‚"
        },
        {
            prompt: "She / live / in Taipei / for ten years",
            answer: "She has lived in Taipei for ten years.",
            type: "Present Perfect",
            reason: "æ™‚é–“é» 'for ten years' è¡¨ç¤ºæŒçºŒäº†ä¸€æ®µæ™‚é–“åˆ°ç¾åœ¨ï¼Œè¦ç”¨ç¾åœ¨å®Œæˆå¼ã€‚"
        },
        {
            prompt: "We / not / see / Tom / last night",
            answer: "We didn't see Tom last night.",
            altAnswer: "We did not see Tom last night.",
            type: "Past Simple",
            reason: "æ™‚é–“é» 'last night' æ˜¯æ˜ç¢ºçš„éå»æ™‚é–“ã€‚éå»å¼å¦å®šéœ€ç”¨ didn't + åŸå½¢å‹•è©ã€‚"
        },
        {
            prompt: "They / visit / Japan / three times",
            answer: "They have visited Japan three times.",
            type: "Present Perfect",
            reason: "æ¬¡æ•¸ 'three times' å¼·èª¿ç´¯ç©çš„ç¶“é©—ï¼Œä¸”æ²’æœ‰èªªæ­»æ™‚é–“ï¼Œç”¨ç¾åœ¨å®Œæˆå¼ã€‚"
        },
        {
            prompt: "Harry / buy / a new car / in 2020",
            answer: "Harry bought a new car in 2020.",
            type: "Past Simple",
            reason: "æ™‚é–“é» 'in 2020' æ˜¯æ˜ç¢ºçš„éå»å¹´ä»½ï¼Œè¦ç”¨éå»å¼ã€‚"
        },
        {
            prompt: "You / finish / your homework / yet",
            answer: "Have you finished your homework yet?",
            type: "Present Perfect (Question)",
            reason: "'Yet' é€šå¸¸ç”¨æ–¼ç¾åœ¨å®Œæˆå¼çš„å•å¥æˆ–å¦å®šå¥ã€‚é€™æ˜¯å•å¥ï¼ŒHave è¦ç§»åˆ°å¥é¦–ã€‚"
        },
        {
            prompt: "My brother / break / his leg / two days ago",
            answer: "My brother broke his leg two days ago.",
            type: "Past Simple",
            reason: "æ™‚é–“é» 'two days ago' (ä»¥å‰) æ˜¯æ˜ç¢ºéå»æ™‚é–“ï¼Œè¦ç”¨éå»å¼ã€‚"
        },
        {
            prompt: "We / know / each other / since high school",
            answer: "We have known each other since high school.",
            type: "Present Perfect",
            reason: "'Since' (è‡ªå¾) è¡¨ç¤ºå¾éå»æŸé»æŒçºŒåˆ°ç¾åœ¨ï¼Œè¦ç”¨ç¾åœ¨å®Œæˆå¼ã€‚"
        },
        {
            prompt: "It / not / rain / this week",
            answer: "It hasn't rained this week.",
            altAnswer: "It has not rained this week.",
            type: "Present Perfect",
            reason: "'This week' é€™ä¸€é€±é‚„æ²’éå®Œï¼Œä¸”å¼·èª¿é€™æ®µæœŸé–“çš„ç‹€æ…‹ï¼Œé€šå¸¸ç”¨ç¾åœ¨å®Œæˆå¼ã€‚"
        },
        {
            prompt: "Where / you / go / for your holiday / last year",
            answer: "Where did you go for your holiday last year?",
            type: "Past Simple (Question)",
            reason: "æ™‚é–“é» 'last year' æ˜¯éå»æ™‚é–“ã€‚ç–‘å•è© Where + did + ä¸»è© + åŸå½¢å‹•è©ï¼Ÿ"
        }
    ];

    let currentQIndex = 0;
    let score = 0;

    const qText = document.getElementById("question-text");
    const qNumber = document.getElementById("q-number");
    const userInput = document.getElementById("user-input");
    const feedbackArea = document.getElementById("feedback-area");
    const submitBtn = document.getElementById("submit-btn");
    const nextBtn = document.getElementById("next-btn");
    const currentScoreDisplay = document.getElementById("current-score");
    const quizArea = document.getElementById("quiz-area");
    const resultArea = document.getElementById("result-area");
    const finalScore = document.getElementById("final-score");

    function loadQuestion() {
        if (currentQIndex >= questions.length) {
            showResult();
            return;
        }
        
        qNumber.textContent = currentQIndex + 1;
        qText.textContent = questions[currentQIndex].prompt;
        userInput.value = "";
        userInput.disabled = false;
        userInput.focus();
        
        // Reset UI
        feedbackArea.style.display = "none";
        feedbackArea.className = "feedback";
        submitBtn.style.display = "inline-block";
        nextBtn.style.display = "none";
    }

    function checkAnswer() {
        let userAns = userInput.value.trim();
        let correctAns = questions[currentQIndex].answer;
        let altAns = questions[currentQIndex].altAnswer;
        let explanation = questions[currentQIndex].reason;

        if (userAns === "") {
            alert("è«‹è¼¸å…¥ç­”æ¡ˆï¼");
            return;
        }

        // ç§»é™¤å¤šé¤˜ç©ºç™½ä¸¦è™•ç†æ¨™é»å¯¬å®¹åº¦ (ç¨å¾®åš´æ ¼ä¸€é»ï¼Œå› ç‚ºæ˜¯è€ƒå¥å‹)
        // ä½†ç‚ºäº†é¿å… frustrationï¼Œæˆ‘å€‘æ¯”å°æ™‚å¿½ç•¥æœ€å¾Œçš„æ¨™é»ï¼Œé¡¯ç¤ºæ™‚å†æé†’
        let cleanUser = userAns.replace(/[.?!]+$/, "");
        let cleanCorrect = correctAns.replace(/[.?!]+$/, "");
        let cleanAlt = altAns ? altAns.replace(/[.?!]+$/, "") : null;

        let isCorrect = (cleanUser === cleanCorrect) || (cleanAlt && cleanUser === cleanAlt);

        // æª¢æŸ¥æ¨™é»ç¬¦è™Ÿ
        let lastChar = userAns.slice(-1);
        let punctWarning = "";
        if (isCorrect && !['.', '?', '!'].includes(lastChar)) {
            punctWarning = "<br>(å°æé†’ï¼šå¥å­çµå°¾è¨˜å¾—åŠ ä¸Šæ¨™é»ç¬¦è™Ÿå–”ï¼)";
        }

        feedbackArea.style.display = "block";
        userInput.disabled = true;
        submitBtn.style.display = "none";
        nextBtn.style.display = "inline-block";
        nextBtn.focus();

        if (isCorrect) {
            score += 10;
            currentScoreDisplay.textContent = score;
            feedbackArea.className = "feedback correct";
            feedbackArea.innerHTML = `<strong>âœ… ç­”å°äº†ï¼</strong>${punctWarning}<br><span class="grammar-tip">${explanation}</span>`;
        } else {
            feedbackArea.className = "feedback wrong";
            feedbackArea.innerHTML = `<strong>âŒ ç­”éŒ¯äº†</strong><br>
            æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š<strong>${correctAns}</strong><br>
            <span class="grammar-tip">ğŸ’¡ è§£æï¼š${explanation}</span>`;
        }
    }

    function nextQuestion() {
        currentQIndex++;
        loadQuestion();
    }

    function showResult() {
        quizArea.style.display = "none";
        resultArea.style.display = "block";
        finalScore.textContent = score;
    }

    function restartQuiz() {
        currentQIndex = 0;
        score = 0;
        currentScoreDisplay.textContent = 0;
        quizArea.style.display = "block";
        resultArea.style.display = "none";
        loadQuestion();
    }

    // æ”¯æ´æŒ‰ Enter é€å‡º
    userInput.addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            if (submitBtn.style.display !== "none") {
                checkAnswer();
            } else if (nextBtn.style.display !== "none") {
                nextQuestion();
            }
        }
    });

    // åˆå§‹åŒ–
    loadQuestion();
</script>

</body>
</html>
