<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><ruby>æ–‡<rt>ã„¨ã„£ËŠ</rt>æ³•<rt>ã„ˆã„šË‡</rt></ruby><ruby>éŠ<rt>ã„§ã„¡ËŠ</rt></ruby><ruby>æˆ²<rt>ã„’ã„§Ë‹</rt></ruby>ï¼šWho...? What...?</title>
    <style>
        /* CSS styles remain the same */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            box-sizing: border-box;
        }
        ruby {
            ruby-position: over;
        }
        rt {
            font-size: 0.7em;
            opacity: 0.9;
        }
        .container {
            text-align: center;
            background: white;
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 600px;
            transition: all 0.3s ease;
        }
        h1 {
            color: #333;
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 28px;
        }
        p {
            color: #666;
            margin-bottom: 20px;
            font-size: 16px;
        }
        #game-image {
            transition: all 0.5s ease;
            width: 150px; /* Ensure image size is consistent */
            height: 150px;
            object-fit: contain;
            margin-bottom: 20px;
            border-radius: 50%;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        #game-image.correct {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }
        #game-image.incorrect {
            animation: shake 0.5s;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }
        #game-image.all-correct {
            animation: celebration 1s ease-in-out;
            box-shadow: 0 8px 25px rgba(253, 203, 110, 0.4);
        }
        #game-status {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex; /* Changed from none to flex */
            align-items: center;
            justify-content: center;
            font-size: 48px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.5s ease;
        }
        #game-status.correct {
            background: linear-gradient(135deg, #00b894, #00a085);
            transform: scale(1.1);
        }
        #game-status.incorrect {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            animation: shake 0.5s;
        }
        #game-status.all-correct {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            animation: celebration 1s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        @keyframes celebration {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(5deg); }
        }
        #progress {
            font-size: 16px;
            color: #555;
            margin-bottom: 15px;
            font-weight: bold;
            padding: 8px 16px;
            background: #f8f9fa;
            border-radius: 20px;
            display: inline-block;
        }
        #question {
            font-size: 22px;
            margin: 20px 0;
            color: #2c3e50;
            line-height: 2;
            background: #f1f3f4;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #74b9ff;
        }
        #options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        .option-btn {
            padding: 15px 20px;
            font-size: 18px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            text-align: center;
            transform: translateY(0);
        }
        .option-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #0984e3, #74b9ff);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .option-btn.correct {
            background: linear-gradient(135deg, #00b894, #00a085) !important;
            transform: scale(1.05);
        }
        .option-btn.incorrect {
            background: linear-gradient(135deg, #fd79a8, #e84393) !important;
            animation: shake 0.5s;
        }
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        #result {
            font-size: 24px;
            margin-top: 20px;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
            line-height: 2;
        }
        #explanation-container {
            font-size: 16px;
            margin-top: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #fffbe6, #fff3cd);
            border-left: 5px solid #f39c12;
            border-radius: 10px;
            text-align: left;
            line-height: 2.2;
            color: #5f4c0a;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        #score {
            font-size: 24px;
            margin-top: 10px;
            color: #333;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-weight: bold;
            line-height: 2;
        }
        #wrong-questions {
            font-size: 16px;
            margin-top: 20px;
            text-align: left;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #e74c3c;
            max-height: 250px;
            overflow-y: auto;
            line-height: 2.5;
        }
        #next-btn, #restart-btn, #retest-wrong-btn {
            padding: 15px 30px;
            font-size: 18px;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        #next-btn { 
            background: linear-gradient(135deg, #fdcb6e, #e17055);
        }
        #next-btn:hover { 
            background: linear-gradient(135deg, #e17055, #fdcb6e);
            transform: translateY(-2px);
        }
        #restart-btn { 
            background: linear-gradient(135deg, #00cec9, #00b894);
        }
        #restart-btn:hover { 
            background: linear-gradient(135deg, #00b894, #00cec9);
            transform: translateY(-2px);
        }
        #retest-wrong-btn { 
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
        }
        #retest-wrong-btn:hover { 
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <img id="game-image" src="initial.png" alt="Game Scene"> 
        <div id="game-status">ğŸ¯</div> 
        
        <h1><ruby>æ–‡<rt>ã„¨ã„£ËŠ</rt>æ³•<rt>ã„ˆã„šË‡</rt></ruby><ruby>éŠ<rt>ã„§ã„¡ËŠ</rt></ruby><ruby>æˆ²<rt>ã„’ã„§Ë‹</rt></ruby>ï¼šWho...? What...?</h1>
        <p><ruby>çœ‹<rt>ã„ã„¢Ë‹</rt></ruby><ruby>çœ‹<rt>ã„ã„¢Ë‹</rt></ruby><ruby>åœ–<rt>ã„Šã„¨ËŠ</rt></ruby><ruby>ç‰‡<rt>ã„†ã„§ã„¢Ë‹</rt></ruby><ruby>æˆ–<rt>ã„ã„¨ã„›Ë‹</rt></ruby><ruby>å¥<rt>ã„ã„©Ë‹</rt></ruby><ruby>å­<rt>ã„—Ë™</rt></ruby>ï¼Œ<ruby>é¸<rt>ã„’ã„©ã„¢Ë‡</rt></ruby><ruby>å‡º<rt>ã„”ã„¨</rt></ruby><ruby>æœ€<rt>ã„—ã„¨ã„ŸË‹</rt></ruby><ruby>æ­£<rt>ã„“ã„¥Ë‹</rt></ruby><ruby>ç¢º<rt>ã„‘ã„©ã„Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ¡ˆ<rt>ã„¢Ë‹</rt></ruby><ruby>å§<rt>Ë™ã„…ã„š</rt></ruby>ï¼</p>
        
        <div id="quiz-area">
            <div id="progress"></div>
            <div id="question"></div>
            <div id="options-container"></div>
            <div id="result"></div>
            <div id="explanation-container" style="display: none;"></div>
            <button id="next-btn" style="display: none;"><ruby>ä¸‹<rt>ã„’ã„§ã„šË‹</rt></ruby><ruby>ä¸€<rt>ã„§ËŠ</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby> â¡ï¸</button>
        </div>

        <div id="end-screen" style="display: none;">
            <h2>ğŸŠ <ruby>æ¸¬<rt>ã„˜ã„œË‹</rt></ruby><ruby>é©—<rt>ã„§ã„¢Ë‹</rt></ruby><ruby>çµ<rt>ã„ã„§ã„ËŠ</rt></ruby><ruby>æŸ<rt>ã„•ã„¨Ë‹</rt></ruby>ï¼ ğŸŠ</h2>
            <div id="score"></div>
            <div id="wrong-questions"></div>
            <button id="restart-btn">ğŸ”„ <ruby>å…¨<rt>ã„‘ã„©ã„¢ËŠ</rt></ruby><ruby>éƒ¨<rt>ã„…ã„¨Ë‹</rt></ruby><ruby>é‡<rt>ã„”ã„¨ã„¥ËŠ</rt></ruby><ruby>æ¸¬<rt>ã„˜ã„œË‹</rt></ruby></button>
            <button id="retest-wrong-btn" style="display: none;">âŒ <ruby>é‡<rt>ã„”ã„¨ã„¥ËŠ</rt></ruby><ruby>æ¸¬<rt>ã„˜ã„œË‹</rt></ruby><ruby>éŒ¯<rt>ã„˜ã„¨ã„›Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby></button>
        </div>
    </div>

<script>
// *** Cleaned Script Block - 15 Questions for Unit 4 ***
const allQuestions = [
    { question: "(<ruby>çœ‹<rt>ã„ã„¢Ë‹</rt></ruby><ruby>åˆ°<rt>ã„‰ã„ Ë‹</rt></ruby><ruby>ä¸€<rt>ã„§ËŠ</rt></ruby><ruby>å€‹<rt>Ë™ã„ã„œ</rt></ruby><ruby>ç”·<rt>ã„‹ã„¢ËŠ</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby>) ___ is he?", options: ["Who", "What"], answer: 0, explanation: "<ruby>è©¢<rt>ã„’ã„©ã„£ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é—œ<rt>ã„ã„¨ã„¢</rt></ruby><ruby>æ–¼<rt>ã„©ËŠ</rt></ruby>ã€Œ<ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby>ã€<ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby>ï¼Œ<ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> Who (<ruby>èª°<rt>ã„•ã„ŸËŠ</rt></ruby>)ã€‚" },
    { question: "(<ruby>çœ‹<rt>ã„ã„¢Ë‹</rt></ruby><ruby>åˆ°<rt>ã„‰ã„ Ë‹</rt></ruby><ruby>ä¸€<rt>ã„§Ë‹</rt></ruby><ruby>éš»<rt>ã„“</rt></ruby><ruby>è›‡<rt>ã„•ã„œËŠ</rt></ruby>) ___ is it?", options: ["Who", "What"], answer: 1, explanation: "<ruby>è©¢<rt>ã„’ã„©ã„£ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é—œ<rt>ã„ã„¨ã„¢</rt></ruby><ruby>æ–¼<rt>ã„©ËŠ</rt></ruby>ã€Œ<ruby>å‹•<rt>ã„‰ã„¨ã„¥Ë‹</rt></ruby><ruby>ç‰©<rt>ã„¨Ë‹</rt></ruby>ã€<ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby>ï¼Œ<ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> What (<ruby>ä»€<rt>ã„•ã„£ËŠ</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby>)ã€‚" },
    { question: "(<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>è‘—<rt>Ë™ã„“ã„œ</rt></ruby><ruby>æ‰‹<rt>ã„•ã„¡Ë‡</rt></ruby><ruby>ä¸Š<rt>ã„•ã„¤Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>é‰›<rt>ã„‘ã„§ã„¢</rt></ruby><ruby>ç­†<rt>ã„…ã„§Ë‡</rt></ruby>) ___ is a pencil.", options: ["This", "That"], answer: 0, explanation: "<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>é <rt>ã„ã„ Ë‹</rt></ruby><ruby>è¿‘<rt>ã„ã„§ã„£Ë‹</rt></ruby><ruby>è‡ª<rt>ã„—Ë‹</rt></ruby><ruby>å·±<rt>ã„ã„§Ë‡</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>æ±<rt>ã„‰ã„¨ã„¥</rt></ruby><ruby>è¥¿<rt>Ë™ã„’ã„§</rt></ruby>ï¼Œ<ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> This (<ruby>é€™<rt>ã„“ã„œË‹</rt></ruby><ruby>å€‹<rt>Ë™ã„ã„œ</rt></ruby>)ã€‚" },
    { question: "(<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>è‘—<rt>Ë™ã„“ã„œ</rt></ruby><ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby><ruby>æ–¹<rt>ã„ˆã„¤</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>æˆ¿<rt>ã„ˆã„¤ËŠ</rt></ruby><ruby>å­<rt>Ë™ã„—</rt></ruby>) ___ is a house.", options: ["This", "That"], answer: 1, explanation: "<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>æ¯”<rt>ã„…ã„§Ë‡</rt></ruby><ruby>è¼ƒ<rt>ã„ã„§ã„ Ë‹</rt></ruby><ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>æ±<rt>ã„‰ã„¨ã„¥</rt></ruby><ruby>è¥¿<rt>Ë™ã„’ã„§</rt></ruby>ï¼Œ<ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> That (<ruby>é‚£<rt>ã„‹ã„šË‹</rt></ruby><ruby>å€‹<rt>Ë™ã„ã„œ</rt></ruby>)ã€‚" },
    { question: "'Who is' <ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>ç¸®<rt>ã„™ã„¨ã„›</rt></ruby><ruby>å¯«<rt>ã„’ã„§ã„Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby>ï¼Ÿ", options: ["Who's", "Whos'"], answer: 0, explanation: "<ruby>ä¸€<rt>ã„§ËŠ</rt></ruby><ruby>æ’‡<rt>ã„†ã„§ã„Ë‡</rt></ruby> (') <ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>æ”¾<rt>ã„ˆã„¤Ë‹</rt></ruby><ruby>åœ¨<rt>ã„—ã„Ë‹</rt></ruby> o <ruby>å’Œ<rt>ã„ã„¢Ë‹</rt></ruby> s <ruby>ä¹‹<rt>ã„“</rt></ruby><ruby>é–“<rt>ã„ã„§ã„¢</part></ruby>ï¼Œ<ruby>ä»£<rt>ã„‰ã„Ë‹</rt></ruby><ruby>æ›¿<rt>ã„Šã„§Ë‹</rt></ruby><ruby>è¢«<rt>ã„…ã„ŸË‹</rt></ruby><ruby>çœ<rt>ã„•ã„¥Ë‡</rt></ruby><ruby>ç•¥<rt>ã„Œã„©ã„Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby> iã€‚" },
    { question: "'What is' <ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>ç¸®<rt>ã„™ã„¨ã„›</rt></ruby><ruby>å¯«<rt>ã„’ã„§ã„Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby>ï¼Ÿ", options: ["Whats'", "What's"], answer: 1, explanation: "<ruby>ä¸€<rt>ã„§ËŠ</rt></ruby><ruby>æ’‡<rt>ã„†ã„§ã„Ë‡</rt></ruby> (') <ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>æ”¾<rt>ã„ˆã„¤Ë‹</rt></ruby><ruby>åœ¨<rt>ã„—ã„Ë‹</rt></ruby> t <ruby>å’Œ<rt>ã„ã„¢Ë‹</rt></ruby> s <ruby>ä¹‹<rt>ã„“</rt></ruby><ruby>é–“<rt>ã„ã„§ã„¢</part></ruby>ï¼Œ<ruby>ä»£<rt>ã„‰ã„Ë‹</rt></ruby><ruby>æ›¿<rt>ã„Šã„§Ë‹</rt></ruby><ruby>è¢«<rt>ã„…ã„ŸË‹</rt></ruby><ruby>çœ<rt>ã„•ã„¥Ë‡</rt></ruby><ruby>ç•¥<rt>ã„Œã„©ã„Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby> iã€‚" },
    { question: "A: ___ this? B: This is Peter.", options: ["Who's", "What's"], answer: 0, explanation: "<ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> Peter (<ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby><ruby>å<rt>ã„‡ã„§ã„¥ËŠ</rt></ruby>)ï¼Œ<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby><ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> Who's (<ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>èª°<rt>ã„•ã„ŸËŠ</rt></ruby>)ã€‚" },
    { question: "A: ___ that? B: That is a mouse.", options: ["Who's", "What's"], answer: 1, explanation: "<ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> a mouse (<ruby>ä¸€<rt>ã„§Ë‹</rt></ruby><ruby>éš»<rt>ã„“</rt></ruby><ruby>è€<rt>ã„Œã„ Ë‡</rt></ruby><ruby>é¼ <rt>ã„•ã„¨Ë‡</rt></ruby>)ï¼Œ<ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>å‹•<rt>ã„‰ã„¨ã„¥Ë‹</rt></ruby><ruby>ç‰©<rt>ã„¨Ë‹</rt></ruby>ï¼Œ<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby><ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> What's (<ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>ä»€<rt>ã„•ã„£ËŠ</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby>)ã€‚" },
    { question: "(<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>è‘—<rt>Ë™ã„“ã„œ</rt></ruby><ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>æ—<rt>ã„†ã„¤ËŠ</rt></ruby><ruby>é‚Š<rt>ã„…ã„§ã„¢</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>åª½<rt>ã„‡ã„š</rt></ruby><ruby>åª½<rt>ã„‡ã„š</rt></ruby>) <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>æ‡‰<rt>ã„§ã„¥</rt></ruby><ruby>è©²<rt>ã„ã„</rt></ruby><ruby>æ€<rt>ã„—ã„£Ë‡</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby>ã€Œ<ruby>é€™<rt>ã„“ã„œË‹</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>èª°<rt>ã„•ã„ŸËŠ</rt></ruby>ã€ï¼Ÿ", options: ["Who's this?", "What's this?", "Who's that?"], answer: 0, explanation: "<ruby>åª½<rt>ã„‡ã„š</rt></ruby><ruby>åª½<rt>ã„‡ã„š</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby>(Who)ï¼Œ<ruby>è€Œä¸”<rt>ã„¦ËŠã„‘ã„§ã„Ë‡</rt></ruby><ruby>åœ¨<rt>ã„—ã„Ë‹</rt></ruby><ruby>æ—<rt>ã„†ã„¤ËŠ</rt></ruby><ruby>é‚Š<rt>ã„…ã„§ã„¢</rt></ruby> (<ruby>è¿‘<rt>ã„ã„§ã„£Ë‹</rt></ruby>ï¼Œthis)ã€‚<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> Who's this?ã€‚" },
    { question: "(<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>è‘—<rt>Ë™ã„“ã„œ</rt></ruby><ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby><ruby>æ–¹<rt>ã„ˆã„¤</rt></ruby><ruby>æ¨¹<rt>ã„•ã„¨Ë‹</rt></ruby><ruby>ä¸Š<rt>ã„•ã„¤Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>é³¥<rt>ã„‹ã„§ã„ Ë‡</rt></ruby>) <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>æ‡‰<rt>ã„§ã„¥</rt></ruby><ruby>è©²<rt>ã„ã„</rt></ruby><ruby>æ€<rt>ã„—ã„£Ë‡</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby>ã€Œ<ruby>é‚£<rt>ã„‹ã„šË‹</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>ä»€<rt>ã„•ã„£ËŠ</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby>ã€ï¼Ÿ", options: ["Who's that?", "What's this?", "What's that?"], answer: 2, explanation: "<ruby>é³¥<rt>ã„‹ã„§ã„ Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>å‹•<rt>ã„‰ã„¨ã„¥Ë‹</rt></ruby><ruby>ç‰©<rt>ã„¨Ë‹</rt></ruby>(What)ï¼Œ<ruby>è€Œä¸”<rt>ã„¦ËŠã„‘ã„§ã„Ë‡</rt></ruby><ruby>åœ¨<rt>ã„—ã„Ë‹</rt></ruby><ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby><ruby>æ–¹<rt>ã„ˆã„¤</rt></ruby> (<ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby>ï¼Œthat)ã€‚<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> What's that?ã€‚" },
    { question: "(<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>è‘—<rt>Ë™ã„“ã„œ</rt></ruby><ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>æ‰‹<rt>ã„•ã„¡Ë‡</rt></ruby><ruby>ä¸Š<rt>ã„•ã„¤Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>è˜‹<rt>ã„†ã„§ã„¥ËŠ</rt></ruby><ruby>æœ<rt>ã„ã„¨ã„›Ë‡</rt></ruby>) <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>æ‡‰<rt>ã„§ã„¥</rt></ruby><ruby>è©²<rt>ã„ã„</rt></ruby><ruby>æ€<rt>ã„—ã„£Ë‡</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby>ã€Œ<ruby>é€™<rt>ã„“ã„œË‹</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>ä»€<rt>ã„•ã„£ËŠ</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby>ã€ï¼Ÿ", options: ["Who's this?", "What's this?", "What's that?"], answer: 1, explanation: "<ruby>è˜‹<rt>ã„†ã„§ã„¥ËŠ</rt></ruby><ruby>æœ<rt>ã„ã„¨ã„›Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>æ±<rt>ã„‰ã„¨ã„¥</rt></ruby><ruby>è¥¿<rt>Ë™ã„’ã„§</rt></ruby>(What)ï¼Œ<ruby>è€Œä¸”<rt>ã„¦ËŠã„‘ã„§ã„Ë‡</rt></ruby><ruby>åœ¨<rt>ã„—ã„Ë‹</rt></ruby><ruby>æ‰‹<rt>ã„•ã„¡Ë‡</rt></ruby><ruby>ä¸Š<rt>ã„•ã„¤Ë‹</rt></ruby> (<ruby>è¿‘<rt>ã„ã„§ã„£Ë‹</rt></ruby>ï¼Œthis)ã€‚<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> What's this?ã€‚" },
    { question: "(<ruby>æŒ‡<rt>ã„“Ë‡</rt></ruby><ruby>è‘—<rt>Ë™ã„“ã„œ</rt></ruby><ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby><ruby>æ–¹<rt>ã„ˆã„¤</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>è­¦<rt>ã„ã„§ã„¥Ë‡</rt></ruby><ruby>å¯Ÿ<rt>ã„”ã„šËŠ</rt></ruby>) <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>æ‡‰<rt>ã„§ã„¥</rt></ruby><ruby>è©²<rt>ã„ã„</rt></ruby><ruby>æ€<rt>ã„—ã„£Ë‡</rt></ruby><ruby>éº¼<rt>Ë™ã„‡ã„œ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby>ã€Œ<ruby>é‚£<rt>ã„‹ã„šË‹</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>èª°<rt>ã„•ã„ŸËŠ</rt></ruby>ã€ï¼Ÿ", options: ["Who's that?", "What's that?", "Who's this?"], answer: 0, explanation: "<ruby>è­¦<rt>ã„ã„§ã„¥Ë‡</rt></ruby><ruby>å¯Ÿ<rt>ã„”ã„šËŠ</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby>(Who)ï¼Œ<ruby>è€Œä¸”<rt>ã„¦ËŠã„‘ã„§ã„Ë‡</rt></ruby><ruby>åœ¨<rt>ã„—ã„Ë‹</rt></ruby><ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby><ruby>æ–¹<rt>ã„ˆã„¤</rt></ruby> (<ruby>é <rt>ã„©ã„¢Ë‡</rt></ruby>ï¼Œthat)ã€‚<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> Who's that?ã€‚" },
    { question: "<ruby>ç•¶<rt>ã„‰ã„¤</rt></ruby><ruby>åˆ¥<rt>ã„…ã„§ã„ËŠ</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby> \"What's this?\"ï¼Œ<ruby>å“ª<rt>ã„‹ã„šË‡</rt></ruby><ruby>å€‹<rt>Ë™ã„ã„œ</rt></ruby><ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>ä¸<rt>ã„…ã„¨ËŠ</rt></ruby><ruby>å°<rt>ã„‰ã„¨ã„ŸË‹</rt></ruby>ï¼Ÿ", options: ["This is a book.", "This is a hamburger.", "This is Mrs. Hill."], answer: 2, explanation: "What <ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby><ruby>ä¾†<rt>ã„Œã„ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>æ±<rt>ã„‰ã„¨ã„¥</rt></ruby><ruby>è¥¿<rt>Ë™ã„’ã„§</rt></ruby><ruby>æˆ–<rt>ã„ã„¨ã„›Ë‹</rt></ruby><ruby>å‹•<rt>ã„‰ã„¨ã„¥Ë‹</rt></ruby><ruby>ç‰©<rt>ã„¨Ë‹</rt></ruby>ã€‚Mrs. Hill <ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby>ï¼Œ<ruby>æ‡‰<rt>ã„§ã„¥</rt></ruby><ruby>è©²<rt>ã„ã„</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> Who <ruby>ä¾†<rt>ã„Œã„ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby>ã€‚" },
    { question: "<ruby>ç•¶<rt>ã„‰ã„¤</rt></ruby><ruby>åˆ¥<rt>ã„…ã„§ã„ËŠ</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby> \"Who's that?\"ï¼Œ<ruby>å“ª<rt>ã„‹ã„šË‡</rt></ruby><ruby>å€‹<rt>Ë™ã„ã„œ</rt></ruby><ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>ä¸<rt>ã„…ã„¨ËŠ</rt></ruby><ruby>å°<rt>ã„‰ã„¨ã„ŸË‹</rt></ruby>ï¼Ÿ", options: ["That is a car.", "That is Tina.", "That is a boy."], answer: 0, explanation: "Who <ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby><ruby>ä¾†<rt>ã„Œã„ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>äºº<rt>ã„–ã„£ËŠ</rt></ruby>ã€‚Car (<ruby>è»Š<rt>ã„”ã„œ</rt></ruby><ruby>å­<rt>Ë™ã„—</rt></ruby>) <ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>æ±<rt>ã„‰ã„¨ã„¥</rt></ruby><ruby>è¥¿<rt>Ë™ã„’ã„§</rt></ruby>ï¼Œ<ruby>æ‡‰<rt>ã„§ã„¥</rt></ruby><ruby>è©²<rt>ã„ã„</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> What <ruby>ä¾†<rt>ã„Œã„ËŠ</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby>ã€‚" },
    { question: "A: ___ that? B: That is a horse.", options: ["Who's", "What's"], answer: 1, explanation: "<ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> horse (<ruby>é¦¬<rt>ã„‡ã„šË‡</rt></ruby>)ï¼Œ<ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby><ruby>å‹•<rt>ã„‰ã„¨ã„¥Ë‹</rt></ruby><ruby>ç‰©<rt>ã„¨Ë‹</rt></ruby>ï¼Œ<ruby>æ‰€<rt>ã„™ã„¨ã„›Ë‡</rt></ruby><ruby>ä»¥<rt>ã„§Ë‡</rt></ruby><ruby>å•<rt>ã„¨ã„£Ë‹</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby><ruby>è¦<rt>ã„§ã„ Ë‹</rt></ruby><ruby>ç”¨<rt>ã„©ã„¥Ë‹</rt></ruby> What'sã€‚" }
];

let currentQuestionIndex = 0;
let score = 0;
let questions = [];
let wrongQuestions = [];

const quizArea = document.getElementById('quiz-area');
const endScreen = document.getElementById('end-screen');
const questionEl = document.getElementById('question');
const optionsContainer = document.getElementById('options-container');
const resultEl = document.getElementById('result');
const explanationEl = document.getElementById('explanation-container');
const progressEl = document.getElementById('progress');
const nextBtn = document.getElementById('next-btn');
const restartBtn = document.getElementById('restart-btn');
const retestWrongBtn = document.getElementById('retest-wrong-btn');
const gameImage = document.getElementById('game-image');
const gameStatus = document.getElementById('game-status');

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function startGame(questionList) {
    questions = [...questionList];
    shuffle(questions);
    currentQuestionIndex = 0;
    score = 0;
    wrongQuestions = [];
    
    quizArea.style.display = 'block';
    endScreen.style.display = 'none';
    gameImage.src = 'initial.png'; // Make sure you have an 'initial.png' or change path
    gameImage.className = '';
    
    // Make sure the status element exists and is displayed
    if (gameStatus) { 
        gameStatus.style.display = 'flex'; 
        gameStatus.textContent = 'ğŸ¯';
        gameStatus.className = '';
    }
    
    showQuestion();
}

function showQuestion() {
    resetState();
    const currentQuestion = questions[currentQuestionIndex];
    progressEl.innerHTML = `<ruby>ç¬¬<rt>ã„‰ã„§Ë‹</rt></ruby> ${currentQuestionIndex + 1} / ${questions.length} <ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby>`;
    questionEl.innerHTML = currentQuestion.question;

    currentQuestion.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.textContent = option; 
        button.classList.add('option-btn');
        button.dataset.index = index;
        button.addEventListener('click', selectAnswer);
        optionsContainer.appendChild(button);
    });
}

function resetState() {
    resultEl.innerHTML = ''; 
    explanationEl.style.display = 'none';
    nextBtn.style.display = 'none';
    while (optionsContainer.firstChild) {
        optionsContainer.removeChild(optionsContainer.firstChild);
    }
    gameImage.src = 'initial.png'; // Reset image
    gameImage.className = '';
    
    if (gameStatus) {
        gameStatus.textContent = 'ğŸ¯';
        gameStatus.className = '';
    }
}

function selectAnswer(e) {
    const selectedBtn = e.target;
    const selectedIndex = parseInt(selectedBtn.dataset.index);
    const currentQuestion = questions[currentQuestionIndex];
    const correctIndex = currentQuestion.answer;

    Array.from(optionsContainer.children).forEach(button => {
        button.disabled = true;
    });

    if (selectedIndex === correctIndex) {
        score++;
        selectedBtn.classList.add('correct');
        resultEl.innerHTML = 'âœ… <ruby>æ­£<rt>ã„“ã„¥Ë‹</rt></ruby><ruby>ç¢º<rt>ã„‘ã„©ã„Ë‹</rt></ruby>ï¼<ruby>å¤ª<rt>ã„Šã„Ë‹</rt></ruby><ruby>æ£’<rt>ã„…ã„¤Ë‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼'; 
        resultEl.style.color = '#2ecc71';
        gameImage.src = 'correct.png'; // Make sure you have a 'correct.png' or change path
        gameImage.classList.add('correct');
        if(gameStatus) {
            gameStatus.textContent = 'ğŸ‰';
            gameStatus.classList.add('correct');
        }
        
        setTimeout(() => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                endGame();
            }
        }, 1500);
    } else {
        selectedBtn.classList.add('incorrect');
        optionsContainer.children[correctIndex].classList.add('correct');
        resultEl.innerHTML = 'âŒ <ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>éŒ¯<rt>ã„˜ã„¨ã„›Ë‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼Œ<ruby>å†<rt>ã„—ã„Ë‹</rt></ruby><ruby>æ¥<rt>ã„ã„§ã„</rt></ruby><ruby>å†<rt>ã„—ã„Ë‹</rt></ruby><ruby>å²<rt>ã„Œã„§Ë‹</rt></ruby>ï¼'; 
        resultEl.style.color = '#e74c3c';
        gameImage.src = 'incorrect.png'; // Make sure you have an 'incorrect.png' or change path
        gameImage.classList.add('incorrect');
         if(gameStatus) {
            gameStatus.textContent = 'ğŸ˜…';
            gameStatus.classList.add('incorrect');
        }
        
        explanationEl.innerHTML = `ğŸ’¡ <ruby>æ–‡<rt>ã„¨ã„£ËŠ</rt></ruby><ruby>æ³•<rt>ã„ˆã„šË‡</rt></ruby><ruby>è§£<rt>ã„ã„§ã„Ë‡</rt></ruby><ruby>æ<rt>ã„’ã„§</rt></ruby>ï¼š${currentQuestion.explanation}`; 
        explanationEl.style.display = 'block';

        wrongQuestions.push({
            ...currentQuestion,
            userAnswer: currentQuestion.options[selectedIndex]
        });
        nextBtn.style.display = 'block';
    }
}

function endGame() {
    quizArea.style.display = 'none';
    endScreen.style.display = 'block';
    
    const scoreEl = document.getElementById('score');
    scoreEl.innerHTML = `ğŸ¯ <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>æœ€<rt>ã„—ã„¨ã„ŸË‹</rt></ruby><ruby>çµ‚<rt>ã„“ã„¨ã„¥</rt></ruby><ruby>åˆ†<rt>ã„ˆã„£</rt></ruby><ruby>æ•¸<rt>ã„•ã„¨Ë‹</rt></ruby>ï¼š${score} / ${questions.length} (${Math.round(score/questions.length*100)}%)`; 

    const wrongQuestionsEl = document.getElementById('wrong-questions');
    if (score === questions.length) {
        gameImage.src = 'all_correct.png'; // Make sure you have an 'all_correct.png' or change path
        gameImage.classList.add('all-correct');
         if(gameStatus) {
            gameStatus.textContent = 'ğŸ†';
            gameStatus.classList.add('all-correct');
        }
        wrongQuestionsEl.innerHTML = 'ğŸŠ <ruby>å¤ª<rt>ã„Šã„Ë‹</rt></ruby><ruby>æ£’<rt>ã„…ã„¤Ë‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼<ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>å…¨<rt>ã„‘ã„©ã„¢ËŠ</rt></ruby><ruby>éƒ¨<rt>ã„…ã„¨Ë‹</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>å°<rt>ã„‰ã„¨ã„ŸË‹</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼<ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>å·²<rt>ã„§Ë‡</rt></ruby><ruby>ç¶“<rt>ã„ã„§ã„¥</rt></ruby><ruby>æ˜¯<rt>ã„•Ë‹</rt></ruby> Who/What <ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>å°<rt>ã„’ã„§ã„ Ë‡</rt></ruby><ruby>å°ˆ<rt>ã„“ã„¨ã„¢</rt></ruby><ruby>å®¶<rt>ã„ã„§ã„š</rt></ruby><ruby>äº†<rt>Ë™ã„Œã„œ</rt></ruby>ï¼ ğŸŠ'; 
        wrongQuestionsEl.style.borderLeftColor = '#2ecc71';
        wrongQuestionsEl.style.background = '#d4edda';
        wrongQuestionsEl.style.color = '#155724';
        wrongQuestionsEl.style.display = 'block';
        retestWrongBtn.style.display = 'none';
    } else {
        gameImage.src = 'not_all_correct.png'; // Make sure you have a 'not_all_correct.png' or change path
         if(gameStatus) {
            gameStatus.textContent = 'ğŸ“';
        }
        let wrongText = `<h3>ğŸ“‹ <ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>éŒ¯<rt>ã„˜ã„¨ã„›Ë‹</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>é¡Œ<rt>ã„Šã„§ËŠ</rt></ruby><ruby>ç›®<rt>ã„‡ã„¨Ë‹</rt></ruby><ruby>å›<rt>ã„ã„¨ã„ŸËŠ</rt></ruby><ruby>é¡§<rt>ã„ã„¨Ë‹</rt></ruby>ï¼š</h3>`;
        wrongQuestions.forEach((q, index) => {
            wrongText += `<p>`;
            wrongText += `${index + 1}. ${q.question}<br>`;
            wrongText += `&nbsp;&nbsp;&nbsp;<ruby>ä½ <rt>ã„‹ã„§Ë‡</rt></ruby><ruby>çš„<rt>Ë™ã„‰ã„œ</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ¡ˆ<rt>ã„¢Ë‹</rt></ruby>: "${q.userAnswer}" âŒ<br>`;
            wrongText += `&nbsp;&nbsp;&nbsp;<ruby>æ­£<rt>ã„“ã„¥Ë‹</rt></ruby><ruby>ç¢º<rt>ã„‘ã„©ã„Ë‹</rt></ruby><ruby>ç­”<rt>ã„‰ã„šËŠ</rt></ruby><ruby>æ¡ˆ<rt>ã„¢Ë‹</rt></ruby>: "${q.options[q.answer]}" âœ…<br>`;
            wrongText += `&nbsp;&nbsp;&nbsp;<ruby>è§£<rt>ã„ã„§ã„Ë‡</rt></ruby><ruby>æ<rt>ã„’ã„§</rt></ruby>: ${q.explanation}<br>`;
            wrongText += `</p>`;
        });
        wrongQuestionsEl.innerHTML = wrongText; 
        wrongQuestionsEl.style.borderLeftColor = '#e74c3c';
        wrongQuestionsEl.style.background = '#f8d7da';
        wrongQuestionsEl.style.color = '#721c24';
        wrongQuestionsEl.style.display = 'block';
        retestWrongBtn.style.display = 'inline-block';
    }
}

nextBtn.addEventListener('click', () => {
    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
        showQuestion();
    } else {
        endGame();
    }
});

restartBtn.addEventListener('click', () => startGame(allQuestions));

retestWrongBtn.addEventListener('click', () => {
    if (wrongQuestions.length > 0) {
        // Create a new list containing only the questions the user got wrong
        const retestList = wrongQuestions.map(({ userAnswer, ...rest }) => rest); 
        startGame(retestList); // Start the game again with only the wrong questions
    }
});

// Start the game initially
startGame(allQuestions);
</script>
</body>
</html>
